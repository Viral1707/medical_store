<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Om Medical Store - Home</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Segoe+UI:400,700&display=swap" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #e0f7fa 0%, #c8e6c9 100%);
            min-height: 100vh;
        }
        .navbar {
            background: linear-gradient(90deg, #2e8b57 60%, #43a047 100%);
            border-radius: 8px;
            margin-bottom: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 0 0 0 0;
            height: 60px;
            display: flex;
            align-items: center;
        }
        .navbar ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
            text-align: center;
        }
        .navbar ul li {
            display: inline-block;
            margin: 0 18px;
        }
        .navbar ul li a {
            color: #fff;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.1em;
            padding: 10px 18px;
            border-radius: 4px;
            transition: background 0.2s;
        }
        .navbar ul li a:hover {
            background: #388e3c;
        }
        .navbar ul li a.active {
            background: #a5d6a7;
            color: #2e8b57;
        }
        .header {
            text-align: center;
            padding: 24px 0 0 0;
            font-size: 2.5em;
            color: #2e8b57;
            font-weight: bold;
            letter-spacing: 2px;
        }
        .search-bar {
            text-align: center;
            margin: 16px 0 0 0;
            position: relative;
        }
        .search-box-wrapper {
            display: inline-block;
            position: relative;
        }
        .search-box {
            padding: 12px;
            width: 320px;
            border: 1px solid #2e8b57;
            border-radius: 4px;
            font-size: 1.1em;
        }
        .search-btn {
            padding: 12px 24px;
            background: linear-gradient(90deg, #2e8b57 60%, #43a047 100%);
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.1em;
            margin-left: 10px;
        }
        .search-btn:hover {
            background: #388e3c;
        }
        .search-dropdown {
            position: absolute;
            left: 0;
            top: 48px;
            width: 320px;
            background: #fff;
            border: 1px solid #2e8b57;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            z-index: 100;
            max-height: 260px;
            overflow-y: auto;
            display: none;
        }
        .search-dropdown ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .search-dropdown li {
            padding: 10px 18px;
            cursor: pointer;
            border-bottom: 1px solid #e0f7fa;
        }
        .search-dropdown li:last-child {
            border-bottom: none;
        }
        .search-dropdown li:hover {
            background: #e0f7fa;
        }
        .hero {
            background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1200&q=80') center/cover no-repeat;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 64px 24px;
            text-align: center;
            margin: 32px 0;
            color: #fff;
            position: relative;
        }
        .hero::after {
            content: '';
            position: absolute;
            left: 0; top: 0; right: 0; bottom: 0;
            background: rgba(46,139,87,0.6);
            border-radius: 12px;
            z-index: 1;
        }
        .hero-content {
            position: relative;
            z-index: 2;
        }
        .hero h1 {
            font-size: 2.7em;
            margin-bottom: 10px;
            font-weight: bold;
            letter-spacing: 2px;
        }
        .hero p {
            font-size: 1.25em;
            margin-bottom: 24px;
        }
        .cta-btn {
            padding: 16px 32px;
            background: #fff;
            color: #2e8b57;
            font-weight: bold;
            font-size: 1.2em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .cta-btn:hover {
            background: #e0f7fa;
        }
        .featured-products {
            max-width: 600px;
            margin: 40px auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 32px;
        }
        .product-card {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 24px;
            text-align: center;
        }
        .product-card img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 12px;
        }
        .product-card h3 {
            color: #2e8b57;
            font-size: 1.1em;
            margin-bottom: 8px;
        }
        .product-card p {
            color: #444;
            font-size: 0.95em;
            margin-bottom: 0;
        }
        .discounts {
            max-width: 600px;
            margin: 40px auto;
            background: linear-gradient(90deg, #ffe0b2 60%, #ffccbc 100%);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 32px;
            text-align: center;
        }
        .discounts h2 {
            color: #d84315;
            margin-bottom: 18px;
        }
        .discounts ul {
            list-style: none;
            padding: 0;
            color: #333;
            font-size: 1.1em;
        }
        .discounts li {
            margin-bottom: 10px;
        }
        .testimonials {
            max-width: 600px;
            margin: 40px auto;
            padding: 32px;
            background: #e1f5fe;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            text-align: center;
        }
        .testimonial {
            display: none;
            font-size: 1.1em;
            color: #444;
        }
        .testimonial.active {
            display: block;
        }
        .testimonial-author {
            margin-top: 12px;
            color: #2e8b57;
            font-weight: bold;
        }
        .testimonial-controls {
            margin-top: 18px;
        }
        .testimonial-controls button {
            background: #2e8b57;
            color: #fff;
            border: none;
            border-radius: 4px;
            padding: 8px 16px;
            margin: 0 6px;
            cursor: pointer;
        }
        .testimonial-controls button:hover {
            background: #43a047;
        }
        .footer {
            background: #2e8b57;
            color: #fff;
            padding: 32px 0 16px 0;
            text-align: center;
            margin-top: 40px;
        }
        .footer .footer-content {
            max-width: 600px;
            margin: 0 auto;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: flex-start;
        }
        .footer-section {
            flex: 1;
            min-width: 220px;
            margin: 0 16px;
        }
        .footer-section h4 {
            margin-bottom: 10px;
            color: #fff;
        }
        .footer-section ul {
            list-style: none;
            padding: 0;
            color: #fff;
        }
        .footer-section li {
            margin-bottom: 8px;
        }
        .footer-section a {
            color: #fff;
            text-decoration: underline;
        }
        .newsletter-form input[type="email"] {
            padding: 8px;
            border-radius: 4px;
            border: none;
            margin-right: 8px;
            width: 180px;
        }
        .newsletter-form button {
            padding: 8px 16px;
            background: #fff;
            color: #2e8b57;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        .newsletter-form button:hover {
            background: #e0f7fa;
        }
        @media (max-width: 900px) {
            .featured-products {
                grid-template-columns: 1fr;
            }
            .footer .footer-content {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="header">Om Medical Store</div>
    <nav class="navbar sticky-navbar navbar-expand-lg bg-success">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link text-white active" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link text-white" href="/products">Products</a></li>
                    <li class="nav-item"><a class="nav-link text-white" href="/services">Services</a></li>
                    <li class="nav-item"><a class="nav-link text-white" href="/aboutus">About Us</a></li>
                    <li class="nav-item"><a class="nav-link text-white" href="/contact">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="search-bar">
        <form action="#" method="get" autocomplete="off" style="display:inline-block;">
            <div class="search-box-wrapper">
                <input type="text" placeholder="Search for products or medicines..." name="search" class="search-box" id="searchBox">
                <div class="search-dropdown" id="searchDropdown">
                    <ul id="searchResults"></ul>
                </div>
            </div>
            <button type="submit" class="search-btn">Search</button>
        </form>
    </div>
    <div class="hero">
        <div class="hero-content">
            <h1>Your Health, Our Priority</h1>
            <p>Trusted by patients, caregivers, and health-conscious customers. Get medicines, wellness products, and expert advice 24/7.</p>
            <button class="cta-btn" onclick="window.location.href='/products'">Shop Now</button>
        </div>
    </div>
    <section class="featured-products">
        <div class="product-card">
            <img src="https://cdn-icons-png.flaticon.com/512/2965/2965567.png" alt="Paracetamol">
            <h3>Paracetamol Tablets</h3>
            <p>Effective relief for fever and pain.</p>
        </div>
        <div class="product-card">
            <img src="https://cdn-icons-png.flaticon.com/512/2965/2965567.png" alt="Vitamin C">
            <h3>Vitamin C Supplements</h3>
            <p>Boost immunity and overall health.</p>
        </div>
        <div class="product-card">
            <img src="https://cdn-icons-png.flaticon.com/512/2965/2965567.png" alt="Hand Sanitizer">
            <h3>Hand Sanitizer</h3>
            <p>Protect yourself from germs and viruses.</p>
        </div>
        <div class="product-card">
            <img src="https://cdn-icons-png.flaticon.com/512/2965/2965567.png" alt="BP Monitor">
            <h3>Blood Pressure Monitor</h3>
            <p>Track your blood pressure at home.</p>
        </div>
        <div class="product-card">
            <img src="https://cdn-icons-png.flaticon.com/512/2965/2965567.png" alt="Face Masks">
            <h3>Face Masks</h3>
            <p>Stay safe with high-quality masks.</p>
        </div>
        <div class="product-card">
            <img src="https://cdn-icons-png.flaticon.com/512/2965/2965567.png" alt="Antiseptic Cream">
            <h3>Antiseptic Cream</h3>
            <p>Fast healing for cuts and wounds.</p>
        </div>
    </section>
    <section class="discounts">
        <h2>Special Discounts</h2>
        <ul>
            <li>10% off on all supplements this month!</li>
            <li>Free home delivery for orders above ₹500</li>
            <li>COVID-19 essentials at discounted prices</li>
        </ul>
    </section>
    <section class="testimonials">
        <div class="testimonial active">
            "Om Medical Store always has what I need and the staff is very helpful!"<br>
            <span class="testimonial-author">- Priya S.</span>
        </div>
        <div class="testimonial">
            "Fast home delivery and genuine products. Highly recommended!"<br>
            <span class="testimonial-author">- Rakesh P.</span>
        </div>
        <div class="testimonial">
            "Great discounts and a wide range of health products."<br>
            <span class="testimonial-author">- Meena T.</span>
        </div>
        <div class="testimonial-controls">
            <button onclick="showTestimonial(-1)">&#8592;</button>
            <button onclick="showTestimonial(1)">&#8594;</button>
        </div>
    </section>
    <div id="productModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.4);z-index:2000;align-items:center;justify-content:center;">
        <div style="background:#fff;padding:2rem 2.5rem;border-radius:12px;box-shadow:0 4px 24px rgba(0,0,0,0.18);max-width:400px;width:90%;position:relative;">
            <button id="closeModalBtn" style="position:absolute;top:12px;right:12px;background:#e57373;color:#fff;border:none;border-radius:50%;width:32px;height:32px;font-size:1.2em;cursor:pointer;">&times;</button>
            <div id="modalContent">
                <!-- Product details will be injected here -->
            </div>
        </div>
    </div>
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Contact Info</h4>
                <ul>
                    <li>Om Medical Store, Vejalpur</li>
                    <li>Phone: +91-9876543210</li>
                    <li>Email: ommedical@email.com</li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Follow Us</h4>
                <ul>
                    <li><a href="#">Facebook</a></li>
                    <li><a href="#">Instagram</a></li>
                    <li><a href="#">Twitter</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Newsletter Signup</h4>
                <form class="newsletter-form" action="#" method="post">
                    <input type="email" placeholder="Your email" required>
                    <button type="submit">Subscribe</button>
                </form>
            </div>
        </div>
        <div style="margin-top:24px; color:#fff; font-size:0.95em;">&copy; 2025 Om Medical Store. All rights reserved.</div>
    </footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        // Testimonials carousel logic
        let currentTestimonial = 0;
        const testimonials = document.querySelectorAll('.testimonial');
        function showTestimonial(direction) {
            testimonials[currentTestimonial].classList.remove('active');
            currentTestimonial = (currentTestimonial + direction + testimonials.length) % testimonials.length;
            testimonials[currentTestimonial].classList.add('active');
        }

        // Product search dropdown logic
        const searchBox = document.getElementById('searchBox');
        const searchDropdown = document.getElementById('searchDropdown');
        const searchResults = document.getElementById('searchResults');
        let productsByCategory = {};

        searchBox.addEventListener('focus', async function() {
            if (Object.keys(productsByCategory).length === 0) {
                const res = await fetch('/api/products/grouped');
                productsByCategory = await res.json();
            }
            showDropdown(productsByCategory, searchBox.value.trim().toLowerCase());
        });

        searchBox.addEventListener('input', function() {
            const val = searchBox.value.trim().toLowerCase();
            showDropdown(productsByCategory, val);
        });

        document.addEventListener('click', function(e) {
            if (!searchBox.contains(e.target) && !searchDropdown.contains(e.target)) {
                searchDropdown.style.display = 'none';
            }
        });

        function showDropdown(groupedProducts, filter) {
            let html = '';
            let found = false;
            for (const category in groupedProducts) {
                // Filter products by name
                const filtered = groupedProducts[category].filter(p => p.name.toLowerCase().includes(filter));
                if (filtered.length > 0) {
                    found = true;
                    html += `<li style='font-weight:bold;background:#e0f7fa;display:flex;align-items:center;'><span style='flex:1;text-align:left;'>${category}</span></li>`;
                    html += filtered.map(p => `<li style='padding-left:24px;'>${p.name}</li>`).join('');
                }
            }
            if (!found) {
                html = '<li>No products found</li>';
            }
            searchResults.innerHTML = html;
            searchDropdown.style.display = 'block';
        }

        let selectedProductId = null;
        let selectedProductName = '';

        function getProductByName(name) {
            for (const category in productsByCategory) {
                for (const p of productsByCategory[category]) {
                    if (p.name === name) return p;
                }
            }
            return null;
        }

        searchResults.addEventListener('click', function(e) {
            if (e.target.tagName === 'LI' && e.target.style.paddingLeft) {
                searchBox.value = e.target.textContent;
                searchDropdown.style.display = 'none';
                const product = getProductByName(e.target.textContent);
                if (product) {
                    selectedProductId = product.id;
                    selectedProductName = product.name;
                }
            }
        });

        document.querySelector('.search-bar form').addEventListener('submit', async function(e) {
            e.preventDefault();
            if (selectedProductId) {
                // Fetch product details via AJAX and show modal
                try {
                    const res = await fetch('/products/' + selectedProductId + '/json');
                    if (res.ok) {
                        const product = await res.json();
                        showProductModal(product);
                    } else {
                        showProductModal({message: 'No product selected or product not found.'});
                    }
                } catch {
                    showProductModal({message: 'Error fetching product details.'});
                }
            } else {
                // Perform a general search or show a message
                const searchTerm = searchBox.value.trim();
                if (searchTerm) {
                    window.location.href = '/products?search=' + encodeURIComponent(searchTerm);
                } else {
                    alert('Please enter or select a product to search.');
                }
            }
        });

        function showProductModal(product) {
            const modal = document.getElementById('productModal');
            const content = document.getElementById('modalContent');
            if (product && product.name) {
                content.innerHTML = `
                    <h2 style='color:#1976d2;'>${product.name}</h2>
                    <img src='${product.imageUrl || "https://cdn-icons-png.flaticon.com/512/2965/2965567.png"}' alt='Product Image' style='width:150px;display:block;margin:0 auto 1.5rem auto;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.10);' />
                    <p class='price'><strong>Price:</strong> ₹${product.price}</p>
                    <p><strong>Description:</strong> ${product.description || "No description."}</p>
                    <p><strong>Category:</strong> ${product.category || "N/A"}</p>
                `;
            } else {
                content.innerHTML = `<div style='background:#fffbe6;border:1px solid #ffe082;border-radius:8px;padding:2rem;text-align:center;'><h3>${product.message || 'No product selected or product not found.'}</h3></div>`;
            }
            modal.style.display = 'flex';
        }
        document.getElementById('closeModalBtn').onclick = function() {
            document.getElementById('productModal').style.display = 'none';
        };
        // --- Display all products grouped by category ---
        // async function renderAllProducts() {
        //     const res = await fetch('/api/products');
        //     const products = await res.json();
        //     // Group by category
        //     const grouped = {};
        //     products.forEach(p => {
        //         if (!grouped[p.category]) grouped[p.category] = [];
        //         grouped[p.category].push(p);
        //     });
        //     let html = '';
        //     Object.keys(grouped).forEach(category => {
        //         html += `<div style="margin-bottom:24px;">
        //             <div style="font-weight:bold;color:#1b5e20;font-size:1.3em;">${category}</div>
        //             <ul style="margin:8px 0 0 18px;">
        //                 ${grouped[category].map(prod => `<li style='color:#333;font-weight:normal;font-size:1.08em;'>${prod.name}</li>`).join('')}
        //             </ul>
        //         </div>`;
        //     });
        //     document.getElementById('all-products').innerHTML = html;
        // }
        // renderAllProducts();
    </script>
</body>
</html>